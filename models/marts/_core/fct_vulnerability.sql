{{
    config(
        materialized='table'
    )
}}

with


disclosed_reports as (
    
    select * from {{ ref('stg_s3__hackerone_disclosed_reports') }}

),

bounty_prices as (
    
    select * from {{ ref('stg_seeds__bounty_prices') }}

),

final as (

    select
        disclosed_reports.*,
        bounty_prices.lower,
        bounty_prices.higher,
        bounty_prices.average

    from disclosed_reports
    left join  bounty_prices
        on disclosed_reports.structured_scope_max_severity = bounty_prices.bounty_type
        and bounty_prices.asset = 'other'

)

select * from final
